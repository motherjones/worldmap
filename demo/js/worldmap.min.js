/*! Worldmap - v0.1.0 - 2013-09-26
* https://github.com/motherjones/worldmap
* Copyright (c) 2013 Mother Jones Data Desk; Licensed MIT */
"use strict";(function(t){var o=t(worldmap);t("#worldmap").append(o);var e=jQuery('<div id="tooltip" style="display: none; position: absolute;"><p>text</p></div>');t("body").prepend(e);var i="<h4>{thedunce}</h4>         <h5>{themistake}</h5>         <p>{whyitswrong}</p>         <p><a href='{source1}'>{source1}</a></p>     ",s=dust.compile(i,"tooltip");dust.loadSource(s);var a="https://docs.google.com/spreadsheet/pub?key=0ArKGUjhunNIudHBJVjkzMkp4X2VOUW5NU1FOelE2VFE&output=html";t(document).ready(function(){Tabletop.init({key:a,callback:function(t){l(t)},simpleSheet:!0})});var l=function(o){for(var i=0;o.length>i;i++){var s=o[i];if(s.tooltip){var a=document.getElementById(s.tooltip);if(a){a&&a.setAttribute("class","has_tooltip");var l=jQuery("#"+s.tooltip);l.attr("fill","#6DCDE9"),dust.render("tooltip",s,function(t,o){l.attr("data-tooltip",o)}),l.bind("mouseout",function(){e.css("display","none")}),l.bind("mousemove",function(t){e.css("left",t.pageX+10).css("top",t.pageY+10).css("display","block").html(jQuery(this).attr("data-tooltip"))}),l.click(function(i){console.log("click");for(var s=0;o.length>s;s++){var a=o[s];if(a.tooltip){var l=t("#"+a.tooltip);l.unbind("mouseout"),l.unbind("mousemove")}}return e.css("left",i.pageX+10).css("top",i.pageY+10).css("display","block").html(jQuery(this).attr("data-tooltip")),i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,!1})}}}t(document).click(function(){for(var i=0;o.length>i;i++){var s=o[i];if(s.tooltip){var a=t("#"+s.tooltip);a.bind("mousemove",function(o){e.css("left",o.pageX+10).css("top",o.pageY+10).css("display","block").html(t(this).attr("data-tooltip"))}),a.bind("mouseout",function(){e.css("display","none")}),e.css("display","none")}}})}})(jQuery);