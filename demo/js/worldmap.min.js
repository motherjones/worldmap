/*! Worldmap - v0.1.0 - 2013-09-26
* https://github.com/motherjones/worldmap
* Copyright (c) 2013 Mother Jones Data Desk; Licensed MIT */
"use strict";(function(t){var o=t(world_map);t("#worldmap").append(o);var e=jQuery('<div id="tooltip" style="display: none; position: absolute;"><p>text</p></div>');t("body").prepend(e);var a=' <p class="quote">{themistake}</p>         <span>â€”<a href="{source1}">{thedunce}</a>, {when}</span> 		<p class="wrong">{whyitswrong}</p>     ',s=dust.compile(a,"tooltip");dust.loadSource(s);var i="https://docs.google.com/spreadsheet/pub?key=0ArKGUjhunNIudHBJVjkzMkp4X2VOUW5NU1FOelE2VFE&output=html";t(document).ready(function(){Tabletop.init({key:i,callback:function(t){p(t)},simpleSheet:!0})});var p=function(o){for(var a=0;o.length>a;a++){var s=o[a];if(s.tooltip){var i=document.getElementById(s.tooltip);if(i){i&&i.setAttribute("class","has_tooltip");var p=jQuery("#"+s.tooltip);p.attr("fill","#6DCDE9"),dust.render("tooltip",s,function(t,o){p.attr("data-tooltip",o)}),p.bind("mouseout",function(){e.css("display","none")}),p.bind("mousemove",function(t){var o=e.outerWidth(),a=t.pageX+10;t.pageX+o>jQuery("#worldmap").outerWidth()+jQuery("#worldmap").offset().left&&(a=t.pageX-o-10),e.css("left",a).css("top",t.pageY+10).css("display","block").html(jQuery(this).attr("data-tooltip"))}),p.click(function(a){for(var s=0;o.length>s;s++){var i=o[s];if(i.tooltip){var p=t("#"+i.tooltip);p.unbind("mouseout"),p.unbind("mousemove")}}return e.css("left",a.pageX+10).css("top",a.pageY+10).css("display","block").html(jQuery(this).attr("data-tooltip")),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,!1})}}}t(document).click(function(){for(var a=0;o.length>a;a++){var s=o[a];if(s.tooltip){var i=t("#"+s.tooltip);i.bind("mousemove",function(o){e.css("left",o.pageX+10).css("top",o.pageY+10).css("display","block").html(t(this).attr("data-tooltip"))}),i.bind("mouseout",function(){e.css("display","none")}),e.css("display","none")}}})}})(jQuery);